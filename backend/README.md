# AI Teacher Assistant - Backend

Backend –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –ø–æ–º–æ—â–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è–º –ö–ö–ò–¢–ò–° (–ö–∞—Ä–∞–≥–∞–Ω–¥–∞).

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# 2. –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –∫–ª—é—á–∏

# 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma –∫–ª–∏–µ–Ω—Ç–∞
npm run db:generate

# 4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã –∫ –ë–î
npm run db:push

# 5. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
node prisma/seed.js

# 6. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
npm run dev
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
DATABASE_URL="postgresql://user:password@host:5432/dbname"

# JWT —Å–µ–∫—Ä–µ—Ç (—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç—Ä–æ–∫—É)
JWT_SECRET="your-secret-key"

# API –∫–ª—é—á–∏ –¥–ª—è –ò–ò
ANTHROPIC_API_KEY="sk-ant-..."
OPENAI_API_KEY="sk-..."

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
PORT=3000
NODE_ENV=development

# URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–¥–ª—è CORS)
FRONTEND_URL="http://localhost:5173"
```

## üì° API Endpoints

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è `/api/auth`
- `POST /register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /login` - –í—Ö–æ–¥
- `GET /me` - –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `PATCH /me` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- `POST /change-password` - –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è

### –ó–∞–¥–∞–Ω–∏—è `/api/tasks`
- `GET /` - –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞–Ω–∏–π
- `GET /:id` - –û–¥–Ω–æ –∑–∞–¥–∞–Ω–∏–µ
- `POST /` - –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ
- `PATCH /:id` - –û–±–Ω–æ–≤–∏—Ç—å
- `DELETE /:id` - –£–¥–∞–ª–∏—Ç—å

### –ì—Ä—É–ø–ø—ã `/api/groups`
- `GET /` - –°–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø
- `GET /:id` - –ì—Ä—É–ø–ø–∞ —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏
- `POST /` - –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É
- `PATCH /:id` - –û–±–Ω–æ–≤–∏—Ç—å
- `DELETE /:id` - –£–¥–∞–ª–∏—Ç—å

### –°—Ç—É–¥–µ–Ω—Ç—ã `/api/students`
- `GET /:id` - –°—Ç—É–¥–µ–Ω—Ç —Å –æ—Ü–µ–Ω–∫–∞–º–∏
- `POST /` - –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞
- `POST /bulk` - –î–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ
- `PATCH /:id` - –û–±–Ω–æ–≤–∏—Ç—å
- `DELETE /:id` - –£–¥–∞–ª–∏—Ç—å

### –û—Ü–µ–Ω–∫–∏ `/api/assessments`
- `GET /task/:taskId` - –û—Ü–µ–Ω–∫–∏ –ø–æ –∑–∞–¥–∞–Ω–∏—é
- `GET /student/:studentId` - –û—Ü–µ–Ω–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞
- `GET /journal/:groupId` - –ñ—É—Ä–Ω–∞–ª –≥—Ä—É–ø–ø—ã
- `POST /` - –í—ã—Å—Ç–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É
- `POST /bulk` - –ú–∞—Å—Å–æ–≤–æ–µ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ
- `DELETE /:id` - –£–¥–∞–ª–∏—Ç—å –æ—Ü–µ–Ω–∫—É

### AI `/api/ai`
- `GET /subjects` - –°–ø–∏—Å–æ–∫ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π –∏ —Ç–µ–º
- `GET /usage` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ò–ò
- `POST /generate-task` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–¥–∞–Ω–∏—è
- `POST /save-task` - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
- `POST /evaluate` - –û—Ü–µ–Ω–∫–∞ —Ä–∞–±–æ—Ç—ã –ò–ò
- `GET /history` - –ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### –ê–¥–º–∏–Ω `/api/admin` (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
- `GET /stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- `GET /users` - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `POST /users` - –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PATCH /users/:id/role` - –ò–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å
- `DELETE /users/:id` - –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /ai-report` - –û—Ç—á—ë—Ç –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ò–ò

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–°—Ö–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç:
- **User** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ –∏ –∞–¥–º–∏–Ω—ã)
- **Task** - –ó–∞–¥–∞–Ω–∏—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- **StudentGroup** - –ì—Ä—É–ø–ø—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- **Student** - –°—Ç—É–¥–µ–Ω—Ç—ã
- **Assessment** - –û—Ü–µ–Ω–∫–∏ —Ä–∞–±–æ—Ç
- **AIHistory** - –ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ò–ò

## ü§ñ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ò–ò

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤–∞ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞:
1. **Claude API** (–æ—Å–Ω–æ–≤–Ω–æ–π) - –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π tier, 50 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å
2. **OpenAI GPT-3.5** (—Ä–µ–∑–µ—Ä–≤–Ω—ã–π) - $5/–º–µ—Å—è—Ü

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ Claude.

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Render

1. –°–æ–∑–¥–∞–π—Ç–µ Web Service –Ω–∞ [render.com](https://render.com)
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ:
   - Build Command: `npm install && npm run db:generate && npm run db:push`
   - Start Command: `npm start`
4. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Environment
5. –°–æ–∑–¥–∞–π—Ç–µ PostgreSQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞ Render
6. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ DATABASE_URL –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìã –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

–ü–æ—Å–ª–µ `node prisma/seed.js`:
- –ê–¥–º–∏–Ω: `admin@kktis.kz` / `admin123`
- –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: `teacher@kktis.kz` / `teacher123`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
backend/
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma    # –°—Ö–µ–º–∞ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ seed.js          # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.js  # Prisma –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ subjects.js  # –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –ö–ö–ò–¢–ò–°
‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.js      # JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ai.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ assessments.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ groups.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ students.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tasks.js
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ aiService.js # –†–∞–±–æ—Ç–∞ —Å Claude/OpenAI
‚îÇ   ‚îî‚îÄ‚îÄ index.js         # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ package.json
```
